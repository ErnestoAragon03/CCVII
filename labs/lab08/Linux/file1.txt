Sincronización de Hilos

(Sistema Bancario Multihilo)
Objetivo

El objetivo de este laboratorio es introducir a los estudiantes en la sincronización de hilos utilizando bloqueos (mutexes) y joins. Mediante la simulación de un sistema bancario, los estudiantes aprenderán a manejar la consistencia de datos y a prevenir condiciones de carrera cuando múltiples hilos accedan a recursos compartidos.
Escenario: Sistema Bancario Multihilo (Transacciones con Múltiples Cajeros Automáticos - ATMs)

Un banco cuenta con múltiples cajeros automáticos (ATMs) que permiten a los clientes depositar o retirar dinero de sus cuentas. Estos ATMs operan simultáneamente y procesan transacciones en paralelo.

Sin embargo, dado que múltiples ATMs pueden acceder a la misma cuenta al mismo tiempo, pueden ocurrir condiciones de carrera, lo que podría llevar a saldos inconsistentes (por ejemplo, una cuenta con saldo negativo o transacciones que se pierden).

Para garantizar la consistencia de los datos, debemos:

    Usar bloqueos (mutexes) para proteger el saldo de la cuenta bancaria compartida.
    Usar joins de hilos para asegurarnos de que todas las transacciones se completen antes de imprimir el saldo final.

Tareas de la Asignación
1. Implementar una Cuenta Bancaria Compartida

    Crear una estructura global de cuenta bancaria que almacene:
        El saldo de la cuenta.
        Un mutex (bloqueo) para proteger las actualizaciones del saldo.
        El sistema debe manejar más de una cuenta.

2. Simular Cajeros Automáticos como Hilos

    Cada cajero automático debe ejecutarse en un hilo separado.
    Cada ATM debe procesar transacciones aleatorias (depósitos y retiros).
    Cada transacción puede afectar a cualquiera de las cuentas disponibles.

3. Implementar Sincronización de Hilos

    Usar bloqueos (mutexes) para prevenir condiciones de carrera al modificar el saldo.
    Usar joins de hilos para asegurarnos de que todos los ATMs terminen de procesar antes de mostrar el saldo final de las cuentas.

4. Sistema de Registro y Manejo de Errores

    Implementar un sistema de registro seguro para hilos, donde cada transacción se registre en un archivo compartido.
    Manejo de errores en las transacciones (por ejemplo, fondos insuficientes, cuenta inexistente).
    Formato del archivo de registro:

    [Vie Mar 14 10:40:19 2025] Retiró $47.00 de la Cuenta 0 | Nuevo Saldo: $1051.00  
    [Vie Mar 14 10:40:19 2025] Retiró $51.00 de la Cuenta 2 | Nuevo Saldo: $1047.00  
    [Vie Mar 14 10:40:19 2025] Depositó $21.00 en la Cuenta 1 | Nuevo Saldo: $1051.00  
    [Vie Mar 14 10:40:19 2025] Transferencia de $14.00 de la Cuenta 1 a la Cuenta 0  
    [Vie Mar 14 10:40:19 2025] Depositó $72.00 en la Cuenta 2 | Nuevo Saldo: $1119.00  
    [Vie Mar 14 10:40:20 2025] Transacción Fallida: Fondos Insuficientes | Cuenta 2  

5. Informe Final

    Al finalizar, mostrar el saldo total de cada cuenta.